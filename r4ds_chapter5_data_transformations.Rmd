---
title: "Chapter 5: Data transformation"
output: 
  html_notebook:
    toc: TRUE
---

# Introduction

## 5.1.1 Prerequisites

```{r}
library(tidyverse)
library(nycflights13)
```

## 5.1.2 nycflights13

```{r}
flights
```

Tibbles are data frames, tweaked to work better in the `tidyverse.` To view the entire dataset: use `View(flights)`.

#### Data types:

-   `int` integers
-   `dbl` doubles, or real numbers
-   `chr` character vectors, or strings
-   `dttm` date-times
-   `lgl` logical
-   `fctr` factors, categorical variables with fixed values
-   `date` dates

## 5.1.3 dyplr basics

#### Key dyplr functions:

-   `filter()` pick observations by their values
-   `arrange()` reorder rows
-   `select()` pick variables by their names
-   `mutate()` create new variables with functions of existing variables
-   `summarise()` collapse many values down\
    First argument is always the dataframe

# 5.2 filter()

Filter flights on January 1st:

```{r}
filter(flights, month == 1, day ==1)
```

To save the result, use the assignment operator `<-`

```{r}
jan1 <-  filter(flights, month == 1, day == 1)
```

## 5.2.1 Comparisons

Use `near()` instead of `==` when comparing floating point numbers.

```{r}
sqrt(2) ^ 2 == 2
near(sqrt(2) ^ 2, 2)
```

## 5.2.2 Logical operators

-   `&` "and"
-   `|` "or"
-   `!` "not" !

![Complete set of boolean operators](https://d33wubrfki0l68.cloudfront.net/01f4b6d39d2be8269740a3ad7946faa79f7243cf/8369a/diagrams/transform-logical.png)

```{r, eval = 2}
filter(flights, month == 1 | month == 12)
filter(flights, month %in% c(11, 12))
```

`%in%` is short-hand since you cannot use `month == (11|12)`. You can also make them explicit variables, e.g. `x` and `y`.

#### De Morgan's laws:  
- `!(x & y)` is the same as `!x | !y`
- `!(x | y)` is the same as `!x & !y`

## 5.2.3 Missing values

`NA` stands for "not availables" and represent unknown/missing values. Any operation with an unknown value will also be unknown.  
`is.na()` is used to determine if a value is missing.  
`filter()` excludes `NA` values. To preserve missing values, ask for it explicitly.
```{r}
df <- tibble(x = c(1, NA, 3))
filter(df, x > 1)

filter(df, is.na(x) | x > 1)

```
